<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

  <title>
    
      Microservices &middot; V1
    
  </title>

  


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon.png" />
<link rel="shortcut icon" href="/favicon.ico" />

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />

  <!-- Additional head bits without overriding original head -->
</head>


  <body class="index home">

    <div id="sidebar">
  <header>
    <h2>
      <a href="/">
        
        Microservices
      </a>
    </h1>
    <p class="lead">Microservices with Azure, ASP.NET and Xamarin</p>
  </header>
  <nav id="sidebar-nav-links">
  
    <a class="home-link  active"
        href="/">Home</a>
  
  

  
<!--
  


  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  
    
  


-->
  


  
    
      <a class="category-link "
          href="/category/01_install_aks.html">01 Create Azure Kubernetes Service</a>
    
  

  
    
      <a class="category-link "
          href="/category/02_install_helm.html">02 Install Helm on Windows</a>
    
  

  
    
      <a class="category-link "
          href="/category/03_install_ingress.html">03 Install an Ingress Controller</a>
    
  

  
    
      <a class="category-link "
          href="/category/04_install_cert_mgr.html">04 Install HTTPS Certificates</a>
    
  

  
    
      <a class="category-link "
          href="/category/05_install_security_gateway.html">05 Install Security Gateway</a>
    
  

  
    
      <a class="category-link "
          href="/category/06_api_services.html">06 API Services</a>
    
  

  
    
      <a class="category-link "
          href="/category/07_messaging_service.html">07 Messaging Service</a>
    
  

  
    
      <a class="category-link "
          href="/category/08_composite_ui.html">08 Composite UI Frontend</a>
    
  

  
    
  

  
    
  

  

  
    
  

  
  <!-- Optional additional links to insert in sidebar nav -->
</nav>


  <hr>
  <nav id="sidebar-icon-links">
  
    <a id="github-link"
       class="icon" title="Github Project" aria-label="Github Project"
       href="https://github.com/rcl-microservices-aks">
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 28"><path d="M12 2c6.625 0 12 5.375 12 12 0 5.297-3.437 9.797-8.203 11.391-0.609 0.109-0.828-0.266-0.828-0.578 0-0.391 0.016-1.687 0.016-3.297 0-1.125-0.375-1.844-0.812-2.219 2.672-0.297 5.484-1.313 5.484-5.922 0-1.313-0.469-2.375-1.234-3.219 0.125-0.313 0.531-1.531-0.125-3.187-1-0.313-3.297 1.234-3.297 1.234-0.953-0.266-1.984-0.406-3-0.406s-2.047 0.141-3 0.406c0 0-2.297-1.547-3.297-1.234-0.656 1.656-0.25 2.875-0.125 3.187-0.766 0.844-1.234 1.906-1.234 3.219 0 4.594 2.797 5.625 5.469 5.922-0.344 0.313-0.656 0.844-0.766 1.609-0.688 0.313-2.438 0.844-3.484-1-0.656-1.141-1.844-1.234-1.844-1.234-1.172-0.016-0.078 0.734-0.078 0.734 0.781 0.359 1.328 1.75 1.328 1.75 0.703 2.141 4.047 1.422 4.047 1.422 0 1 0.016 1.937 0.016 2.234 0 0.313-0.219 0.688-0.828 0.578-4.766-1.594-8.203-6.094-8.203-11.391 0-6.625 5.375-12 12-12zM4.547 19.234c0.031-0.063-0.016-0.141-0.109-0.187-0.094-0.031-0.172-0.016-0.203 0.031-0.031 0.063 0.016 0.141 0.109 0.187 0.078 0.047 0.172 0.031 0.203-0.031zM5.031 19.766c0.063-0.047 0.047-0.156-0.031-0.25-0.078-0.078-0.187-0.109-0.25-0.047-0.063 0.047-0.047 0.156 0.031 0.25 0.078 0.078 0.187 0.109 0.25 0.047zM5.5 20.469c0.078-0.063 0.078-0.187 0-0.297-0.063-0.109-0.187-0.156-0.266-0.094-0.078 0.047-0.078 0.172 0 0.281s0.203 0.156 0.266 0.109zM6.156 21.125c0.063-0.063 0.031-0.203-0.063-0.297-0.109-0.109-0.25-0.125-0.313-0.047-0.078 0.063-0.047 0.203 0.063 0.297 0.109 0.109 0.25 0.125 0.313 0.047zM7.047 21.516c0.031-0.094-0.063-0.203-0.203-0.25-0.125-0.031-0.266 0.016-0.297 0.109s0.063 0.203 0.203 0.234c0.125 0.047 0.266 0 0.297-0.094zM8.031 21.594c0-0.109-0.125-0.187-0.266-0.172-0.141 0-0.25 0.078-0.25 0.172 0 0.109 0.109 0.187 0.266 0.172 0.141 0 0.25-0.078 0.25-0.172zM8.937 21.438c-0.016-0.094-0.141-0.156-0.281-0.141-0.141 0.031-0.234 0.125-0.219 0.234 0.016 0.094 0.141 0.156 0.281 0.125s0.234-0.125 0.219-0.219z"></path>
</svg>

    </a>
    <!--
    <a id="github-download-link"
       class="icon" title="Download" aria-label="Download"
       href="https://github.com/rcl-microservices-aks/archive/v3.zip">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>
    </a>
    -->
  

   <!--
  <a id="subscribe-link"
     class="icon" title="Subscribe" aria-label="Subscribe"
     href="/feed.xml">
    <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <circle cx="6.18" cy="17.82" r="2.18"/>
    <path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/>
</svg>
  </a>

  
  
  
  

  
    <a id="tags-link"
       class="icon"
       title="Tags" aria-label="Tags"
       href="/tags.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
    </a>
  

  
  -->
  <!-- Optional additional links to insert for icons links -->
</nav>
  <p>
  &copy; 2018.
  <a href="/LICENSE.md">MIT License.</a>
</p>

</div>

    <main class="container">
      <header>
  <h1 class="page-title">Home</h1>
</header>
<div class="content">
  <h2 id="introduction">Introduction</h2>

<p>In this series of articles, we will walk you through a demonstration application that was built with Microservices from the ground up.</p>

<p>This section will provide an overview of Microservices by describing how we created the demo application. Later on, you can try installing the various services and explore their features to understand how they work together.</p>

<h3 id="azure-kubernetes-services-aks">Azure Kubernetes Services (AKS)</h3>

<p>Microsoft Azure Kubernetes Services (AKS) is an orchestration service for hosting Microservices. The following is a description of the demo applications hosted in AKS.</p>

<h3 id="nodes">Nodes</h3>

<p>A node is a Virtual Machine (VM) in the cluster. Each node has the services necessary to run pods and is managed by a master component.</p>

<h3 id="pods">Pods</h3>

<p>A pod is a docker container, with shared storage/network, and a specification for how to run the containers. Pods are run in nodes.</p>

<h3 id="cluster">Cluster</h3>

<p>The group of nodes , as a whole, is called a cluster. The following diagram illustrates our Azure Kubernetes Service (AKS) cluster.</p>

<p><img src="https://raw.githubusercontent.com/rcl-microservices-aks/documentation/master/images/intro/cluster.PNG" alt="placeholder" title="Image" /></p>

<h3 id="services">Services</h3>

<p>The main microservices that make up the demo application are:</p>

<ul>
  <li>Product Service - This is an ASP.NET Core Web API that manages product data.</li>
  <li>Order Service - This is an ASP.NET Core Web API that manages order data.</li>
  <li>Identity Service - This is an ASP.NET MVC application that provides single-sign-on for the frontend website and provides authorization services for the Web APIs.</li>
  <li>Store Frontend - This is an ASP.NET Core MVC application that will serve as our store front end website.</li>
</ul>

<h3 id="high-availability">High Availability</h3>

<p>For high availability, the AKS cluster automatically assigns different instances of services to pods and nodes. Later on, we will see how requests are routed to services within the pods to load balance the requests.</p>

<p><img src="https://raw.githubusercontent.com/rcl-microservices-aks/documentation/master/images/intro/cluster-2.PNG" alt="placeholder" title="Image" /></p>

<h3 id="data">Data</h3>

<p>The central theme in Microservices is the de-coupling of each service. Services should handle a single business activity, and are usually small applications that can be developed by a few persons. Services should not have any strongly coupled dependency on the other services. Each service should be within a bounded domain as per the Domain-Driven-Design Model (DDD).</p>

<p>Each domain bounded services may have its own database. However, the demo application shares a common database for economic reasons. The tables for each service is independent of the tables for the other services.</p>

<p><img src="https://raw.githubusercontent.com/rcl-microservices-aks/documentation/master/images/intro/cluster-3.PNG" alt="placeholder" title="Image" /></p>

<h3 id="load-balancer-and-ingress-controller">Load Balancer and Ingress Controller</h3>

<p>Requests to the demo application is routed through a Load Balancer. An ingress controller is responsible for routing requests to the services. There is one external public IP address and DNS name for the application. For instance, the public IP for the cluster may be : ‘23.100.26.95’ and the DNS may be : ‘rclappdev.eastus.cloudapp.azure.com’. In the demo, requests are routed based on paths. As an example, a request with a path ‘/store’ (https://rclappdev.eastus.cloudapp.azure.com/store) will be routed to the store frontend website.</p>

<p>The communication between the web frontend and the APIs is also done through the ingress controller. For instance, a request from the fronted website to the Product Service using the path ‘/productsvc’ (https://rclappdev.eastus.cloudapp.azure.com/productsvc) will be routed to the Product Service Web API.</p>

<p><img src="https://raw.githubusercontent.com/rcl-microservices-aks/documentation/master/images/intro/cluster-4.PNG" alt="placeholder" title="Image" /></p>

<h3 id="https-termination">HTTPS Termination</h3>

<p>The Ingress Controller is also responsible for the TLS termination of all requests. HTTPS certificates are provided for the frontend website and each service by the cert-manager service that generates HTTPS certificates via the ‘Let’s Encrypt’ project.</p>

<h3 id="authentication-and-authorization-services">Authentication and Authorization Services</h3>

<h4 id="single-sign-on">Single Sign On</h4>

<p>Identity Service provides Single-Sign-On (SSO) for the frontend website. When the user clicks the ‘Login’ link in the frontend website, they are signed in using a login web page provided by Identity Service. Apart from the user authentication, Identity Service will provide the frontend website with a set of authentication claims that are assigned to the user. These authentication claims can be used to gain access to various operations on the website, for example, access to a membership or admin page.</p>

<p><img src="https://raw.githubusercontent.com/rcl-microservices-aks/documentation/master/images/intro/sso.PNG" alt="placeholder" title="Image" /></p>

<h4 id="authorized-api-access">Authorized API Access</h4>

<p>Identity Service also provides security access to the Web APIs. The steps for securing an API are as follows:</p>

<ul>
  <li>Request a Token - The frontend website requests a JWT access token from Identity Service to make a secured request to an API</li>
  <li>Provide a Token - Identity service will send the access token to the frontend website once it provides the right client id and secret to access the token</li>
  <li>Make and authenticated request - The frontend website will place the bearer token in the header and make a secured request to the API</li>
  <li>Return JSON Payload - Once the request is authorized by the API, the API will return the JSON payload to the frontend website</li>
</ul>

<p><img src="https://raw.githubusercontent.com/rcl-microservices-aks/documentation/master/images/intro/api-auth.PNG" alt="placeholder" title="Image" /></p>

<h3 id="communication-between-api-services">Communication Between API Services</h3>

<p>APIs can communicate with each other using REST or asynchronous messaging. The demo application uses Azure Service Bus messaging services for communication. The following example will illustrate the concept of messaging.</p>

<p>The Product Service tracks the inventory of items with an ‘inStock’ field in the database. Each time an order is created by the Order Service, the Product Service will reduce the ‘inStock’ value of the product by one. So if there are 1000 pencils in stock, and an order is created for a pencil, the ‘inStock’ value for pencils is reduced to 999.</p>

<p>The Order Service can send a request directly to the Product Service via REST to update the ‘inStock’ value of the product in the database. However, this will create a dependency between the Order Service and the Product Service. A better approach would be to use a broker messaging service to accomplish this communication.</p>

<p>We can use ‘Topics’ in Azure Service Bus to create a Publish/Subscribe messaging service. The Order Service will publish a message to a Topic called ‘Created-Order’ each time an order is created. The message will be a simple JSON string containing the product id and other fields related to the order. Now, any service can subscribe to this Topic. The Product Service will subscribe to the Topic, and each time an order is created, the JSON string message will be transmitted to the Product Service asynchronously. The Product Service will then use the product id field in the JSON to find the product that was ordered and then reduce the ‘inStock’ value of the product by one.</p>

<p>You will observe that the Order Service does not know anything about the Product Service as it is only aware of Service Bus. Similarly, the Product Service is only aware of the Service Bus and not the Order Service. In this way, both services are completely de-coupled.</p>

<p>This approach also makes our application extensible. Say we now have a Shipping Service. The shipping service can subscribe to the ‘Created-Order’ Topic, and each time a new order is created it can send out an instruction to have the order shipped to a customer address.</p>

<p>Messaging also adds reliability to the application. For instance, if the Product Service is down, the message will remain in the Topic queue until the Product Service is back up again to consume it.</p>

<p><img src="https://raw.githubusercontent.com/rcl-microservices-aks/documentation/master/images/intro/messaging.PNG" alt="placeholder" title="Image" /></p>

<h3 id="next-steps">Next Steps</h3>

<p>The other articles in this website will walk you through installing the demo application and exploring the concepts we introduced above in greater detail.</p>

<p>Next Article : <a href="/category/01_install_aks">Create Azure Kubernetes Service</a></p>


</div>


  <section class="comments">
    <h2>Comments</h2>
    
  <div id="disqus_thread">
    <button class="disqus-load" onClick="loadDisqusComments()">
      Load Comments
    </button>
  </div>
  <script>

  /**
  *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW
  *  TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT:s
  *  https://disqus.com/admin/universalcode/#configuration-variables
  */
  var disqus_config = function () {
    this.page.url = "http://localhost:4000/";
    this.page.identifier = "" ||
                           "http://localhost:4000/";
  }
  function loadDisqusComments() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//rcl-micro-service.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  }
  </script>
  <noscript>
    Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript">comments powered by Disqus</a>.
  </noscript>



  </section>

    </main>

    <!-- Optional footer content -->

  </body>
</html>
